webpackJsonp([1,2],{118:function(t,e,n){n(400);var r=n(45)(null,n(411),null,null);t.exports=r.exports},121:function(t,e,n){"use strict";var r=n(59),o=n.n(r),s=n(119),a=n(179),i=n(176),c=n(178),u=n(177);o.a.use(s.c),e.a=new s.c.Store({state:a.a,actions:i.a,mutations:c.a,modules:{projects:u.a}})},122:function(t,e,n){"use strict";function r(t,e){var n=t[e.host];return n&&e.owner in n&&e.project in n[e.owner]&&e.build in n[e.owner][e.project]}e.a=r},162:function(t,e,n){"use strict";var r=n(59),o=n.n(r),s=n(415),a=n(121);o.a.use(s.a);var i=new s.a({routes:[n(175),n(173),n(174)]});i.beforeEach(function(t,e,n){a.a.state.token||"token"===t.name?n():n({name:"token"})}),e.a=i},164:function(t,e,n){var r=n(45)(n(166),n(414),null,null);t.exports=r.exports},166:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={name:"app",components:{"page-header":n(403)}}},167:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(119),o=n(78);e.default={data:function(){return{fetching:!0}},computed:n.i(r.b)({projects:"projectOverview"}),components:{container:n(118)},mounted:function(){var t=this;0===this.$store.state.projects.all.length?n.i(o.a)("projects").then(function(t){if(200===t.status)return t.json();throw new Error(t)}).then(function(e){return t.$store.dispatch("fetchProject",e)}).then(function(){return t.fetching=!1}).catch(function(){localStorage.removeItem("api-token"),t.$router.replace({name:"token"})}):this.fetching=!1}}},168:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={data:function(){return{}},components:{container:n(118),"report-card":n(406)}}},169:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(183),o=n.n(r),s=n(119),a=n(78),i=n(122);e.default={props:["owner","projectName","build","host"],data:function(){return{fetching:!0,project:null,reports:[],error:null}},computed:o()({badge:function(){return"https://circleci.com/"+("github"===this.host?"gh":"bb")+"/"+this.owner+"/"+this.projectName+"/tree/master.svg?style=svg&circle-token="+this.token}},n.i(s.a)(["token"]),n.i(s.b)(["getProject","getReport"])),mounted:function(){this.displayReport(this.host,this.owner,this.projectName,this.build)},watch:{owner:function(){this.displayReport(this.host,this.owner,this.projectName,this.build)},build:function(){this.displayReport(this.host,this.owner,this.projectName,this.build)},projectName:function(){this.displayReport(this.host,this.owner,this.projectName,this.build)},host:function(){this.displayReport(this.host,this.owner,this.projectName,this.build)}},methods:{titleReport:function(t){var e=t.replace("$CIRCLE_ARTIFACTS/","").replace("/index.html","");return""+e.charAt(0).toUpperCase()+e.substr(1)},displayReport:function(t,e,r,o){var s=this,c=this.$store.state.projects.reports,u=function(){s.error=null,s.fetching=!1,s.project=s.getProject(e,r),s.reports=s.getReport(t,e,r,o)};n.i(i.a)(c,{host:t,owner:e,project:r,build:o})?u():n.i(a.a)("project/"+t+"/"+e+"/"+r+"/"+o+"/artifacts").then(function(t){if(200===t.status)return t.json();throw t}).then(function(n){return s.$store.dispatch("fetchReport",{host:t,owner:e,project:r,build:o,data:n})}).then(function(){return u()}).catch(function(t){console.trace(t),s.fetching=!1,s.error="Response with status "+t.status+", please check fetching correct report or url project exists"})}}}},170:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(118),o=n.n(r);e.default={data:function(){return{token:""}},components:{container:o.a},methods:{submit:function(){localStorage.setItem("api-token",this.token),this.$store.dispatch("saveToken",this.token),this.$router.replace({name:"home"})}}}},171:function(t,e,n){"use strict";var r=n(60),o=n.n(r),s=n(184),a=n.n(s);e.a=function(t){if(!(t instanceof Headers))return t&&"object"===(void 0===t?"undefined":a()(t))?o()({},{Accept:"application/json"},t):{Accept:"application/json"};t.set("Accept","application/json")}},172:function(t,e,n){"use strict";t.exports=function(t){var e=localStorage.getItem("api-token"),n=new URL(t,"https://circleci.com/api/v1.1/").toString();return n+(n.indexOf("?")!==-1?"&":"?")+"circle-token="+e}},173:function(t,e,n){"use strict";t.exports={path:"/",name:"home",component:n(404)}},174:function(t,e,n){"use strict";t.exports={path:"/report/:host/:owner/:project/:build",name:"report",component:n(405)}},175:function(t,e,n){"use strict";t.exports={path:"/token",name:"token",component:n(407)}},176:function(t,e,n){"use strict";var r=n(79);e.a={saveToken:function(t,e){(0,t.commit)(r.c,e)}}},177:function(t,e,n){"use strict";function r(t,e){if(!e)return"success";if(t&&t.build_num>e.build_num)return"success";var n=e.outcome;return p.indexOf(n)!==-1?"warn":"fail"}var o,s=n(123),a=n.n(s),i=n(60),c=n.n(i),u=n(79),l=n(122),p=["canceled","no_tests"],f={all:[],reports:{bitbucket:{},github:{}}},d=(o={},a()(o,u.a,function(t,e){t.all=e}),a()(o,u.b,function(t,e){var n=e.host,r=e.owner,o=e.project,s=e.build,i=e.data;t.reports=c()({},t.reports,a()({},n,a()({},r,a()({},o,a()({},s,i)))))}),o),h={fetchProject:function(t,e){(0,t.commit)(u.a,e)},fetchReport:function(t,e){(0,t.commit)(u.b,e)}},m={allProject:function(t){return t.all},projectOverview:function(t,e){return e.allProject.map(function(t){var e=t.branches.master.last_success,n=t.branches.master.last_non_success,o=r(e,n),s="success"===o?e:n;return{status:o,report:{name:"report",params:{host:t.vcs_type,owner:t.username,project:t.reponame,build:s.build_num}},commit:s.vcs_revision.substr(0,6),icon:t.vcs_type,name:t.reponame,build:s.build_num,url:t.vcs_url,owner:t.username}})},getProject:function(t,e){var n=e.projectOverview;return function(t,e){var r=n.filter(function(n){return n.name===e&&n.owner===t});return r.length>0?r[0]:null}},getReport:function(t){return function(e,r,o,s){if(n.i(l.a)(t.reports,{host:e,owner:r,project:o,build:s})){var a=t.reports[e][r][o][s],i=a.filter(function(t){return t.path.endsWith("index.html")}),c=i.reduce(function(t,e){var n=e.pretty_path.split("/").length;return n<t?n:t},1/0);return i.filter(function(t){return t.pretty_path.split("/").length===c})}return[]}}};e.a={state:f,mutations:d,actions:h,getters:m}},178:function(t,e,n){"use strict";var r=n(123),o=n.n(r),s=n(79);e.a=o()({},s.c,function(t,e){t.token=e})},179:function(t,e,n){"use strict";var r=localStorage.getItem("api-token");e.a={token:r}},398:function(t,e){},399:function(t,e){},400:function(t,e){},403:function(t,e,n){n(398);var r=n(45)(null,n(409),"data-v-09f4815e",null);t.exports=r.exports},404:function(t,e,n){n(399);var r=n(45)(n(167),n(410),"data-v-0fdc74f0",null);t.exports=r.exports},405:function(t,e,n){var r=n(45)(n(168),n(408),null,null);t.exports=r.exports},406:function(t,e,n){var r=n(45)(n(169),n(412),null,null);t.exports=r.exports},407:function(t,e,n){var r=n(45)(n(170),n(413),null,null);t.exports=r.exports},408:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("container",[n("report-card",{attrs:{host:t.$route.params.host,owner:t.$route.params.owner,projectName:t.$route.params.project,build:t.$route.params.build}})],1)},staticRenderFns:[]}},409:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("md-toolbar",[n("h1",{staticClass:"md-title"},[n("router-link",{attrs:{to:{name:"home"}}},[t._v("\n            Circle CI Dashboard\n        ")])],1)])},staticRenderFns:[]}},410:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("container",[n("h2",[t._v("Projects")]),t._v(" "),t.fetching?n("br"):t._e(),t._v(" "),t.fetching?n("md-progress",{attrs:{"md-indeterminate":""}}):t._e(),t._v(" "),t._l(t.projects,function(e){return n("md-card",{key:e.name,staticClass:"md-primary",attrs:{"md-theme":e.status}},[n("md-card-header",[n("div",{staticClass:"md-title"},[t._v("\n                "+t._s(e.name)+"\n                "),n("i",{staticClass:"fa",class:["fa-"+e.icon]})]),t._v(" "),n("div",{staticClass:"md-subhead"},[t._v("\n                #"+t._s(e.build)+"\n                "+t._s(e.commit)+"\n            ")])]),t._v(" "),n("md-card-actions",["warn"!==e.status?n("md-button",{staticClass:"md-raised",attrs:{href:t.$router.resolve(e.report).href}},[t._v("\n                View Report\n            ")]):t._e()],1)],1)})],2)},staticRenderFns:[]}},411:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement;return(t._self._c||e)("div",{staticClass:"container"},[t._t("default")],2)},staticRenderFns:[]}},412:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("md-card",[n("md-card-header",[null===t.error?n("div",{staticClass:"md-title"},[n("h2",[t._v("\n                "+t._s(t.owner)+" / "+t._s(t.projectName)+"\n                #"+t._s(t.build)+"\n                "),null!==t.project?n("a",{attrs:{href:t.project.url,target:"_blank"}},[n("i",{staticClass:"fa",class:"fa-"+t.host})]):t._e(),t._v(" "),t.badge?n("img",{attrs:{src:t.badge}}):t._e()])]):t._e(),t._v(" "),null!==t.error?n("div",{staticClass:"md-title"},[t._v("\n            Error occur\n        ")]):t._e()]),t._v(" "),n("md-card-content",[t.fetching?n("md-progress",{attrs:{"md-indeterminate":""}}):t._e(),t._v(" "),t.reports.length>0?n("md-list",t._l(t.reports,function(e){return n("md-list-item",{key:e.path,attrs:{href:e.url,target:"_blank"}},[t._v("\n                "+t._s(t.titleReport(e.pretty_path))+"\n                "),n("md-icon",[t._v("send")])],1)})):t._e()],1),t._v(" "),null!==t.error?n("md-card-content",[t._v("\n        "+t._s(t.error)+"\n    ")]):t._e(),t._v(" "),null!==t.error?n("md-card-actions",[n("md-button",{staticClass:"md-raised md-accent",attrs:{href:t.$router.resolve({name:"home"}).href}},[t._v("Home")])],1):t._e()],1)},staticRenderFns:[]}},413:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("container",[n("h2",[t._v("Input Token")]),t._v(" "),n("form",{attrs:{novalidate:""},on:{submit:function(e){e.stopPropagation(),e.preventDefault(),t.submit(e)}}},[n("md-input-container",[n("label",[t._v("Circle CI API Token")]),t._v(" "),n("md-input",{model:{value:t.token,callback:function(e){t.token=e}}})],1),t._v(" "),n("p",[t._v("\n      You may go to\n      "),n("a",{attrs:{href:"https://circleci.com/account/api",target:"_blank"}},[t._v("here")]),t._v("\n      to create a new API token\n    ")]),t._v(" "),n("md-button",{staticClass:"md-raised md-primary",attrs:{type:"submit"}},[t._v("\n      Submit\n    ")])],1)])},staticRenderFns:[]}},414:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("page-header"),t._v(" "),n("transition",{attrs:{name:"fade",mode:"out-in"}},[n("router-view")],1)],1)},staticRenderFns:[]}},417:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(163),o=(n.n(r),n(59)),s=n.n(o),a=n(165),i=n.n(a),c=n(164),u=n.n(c),l=n(162),p=n(121),f=n(78);s.a.use(i.a),s.a.material.registerTheme("default",{primary:"purple"}),s.a.material.registerTheme({success:{primary:"green"},fail:{primary:"red"},warn:{primary:"orange"}}),p.a.state.projects.all.length||n.i(f.a)("projects").then(function(t){if(200===t.status)return t.json();throw new Error(t)}).then(function(t){return p.a.dispatch("fetchProject",t)}).catch(function(){localStorage.removeItem("api-token"),l.a.replace({name:"token"})}),new s.a({el:"#app",router:l.a,store:p.a,template:"<App/>",components:{App:u.a}})},78:function(t,e,n){"use strict";var r=n(60),o=n.n(r),s=n(172),a=n.n(s),i=n(171),c=window.fetch;e.a=function(t,e){return c(a()(t),e?o()({},{headers:n.i(i.a)(e.headers)},e||{}):{headers:{Accept:"application/json"}})}},79:function(t,e,n){"use strict";n.d(e,"c",function(){return r}),n.d(e,"a",function(){return o}),n.d(e,"b",function(){return s});var r="SET_TOKEN",o="FETCH_PROJECT",s="FETCH_REPORT"}},[417]);
//# sourceMappingURL=app.js.map